

 31%|█████████████████▌                                       | 4001/12999 [00:04<00:10, 839.94it/s]

 31%|█████████████████▌                                       | 4002/12999 [00:07<00:10, 839.94it/s]
{'loss': 1.3662, 'learning_rate': 1.6216514252195686e-05, 'epoch': 0.92}


 31%|█████████████████▌                                       | 4004/12999 [00:12<00:10, 839.94it/s]

 31%|█████████████████▌                                       | 4005/12999 [00:15<00:10, 839.94it/s]

 31%|█████████████████▌                                       | 4006/12999 [00:18<00:54, 164.90it/s]

 31%|█████████████████▌                                       | 4007/12999 [00:21<01:06, 135.28it/s]

 31%|█████████████████▌                                       | 4008/12999 [00:23<01:06, 135.28it/s]

 31%|█████████████████▌                                       | 4009/12999 [00:26<01:06, 135.28it/s]

 31%|█████████████████▌                                       | 4010/12999 [00:28<01:06, 135.28it/s]

 31%|█████████████████▌                                       | 4011/12999 [00:31<01:06, 135.28it/s]
{'loss': 1.5911, 'learning_rate': 1.619893410721028e-05, 'epoch': 0.93}


 31%|█████████████████▉                                        | 4013/12999 [00:36<02:48, 53.22it/s]

 31%|█████████████████▉                                        | 4014/12999 [00:39<03:13, 46.53it/s]
{'loss': 1.9432, 'learning_rate': 1.619306712778927e-05, 'epoch': 0.93}


 31%|█████████████████▉                                        | 4016/12999 [00:44<03:13, 46.53it/s]

 31%|█████████████████▉                                        | 4017/12999 [00:47<03:13, 46.53it/s]
{'loss': 1.6534, 'learning_rate': 1.618719668828354e-05, 'epoch': 0.93}


 31%|█████████████████▉                                        | 4019/12999 [00:52<03:13, 46.53it/s]

 31%|█████████████████▉                                        | 4020/12999 [00:55<03:12, 46.53it/s]

 31%|█████████████████▉                                        | 4021/12999 [00:57<07:11, 20.80it/s]

 31%|█████████████████▉                                        | 4022/12999 [01:00<07:59, 18.71it/s]

 31%|█████████████████▉                                        | 4023/12999 [01:03<07:59, 18.71it/s]

 31%|█████████████████▉                                        | 4024/12999 [01:05<07:59, 18.71it/s]

 31%|█████████████████▉                                        | 4025/12999 [01:08<07:59, 18.71it/s]

 31%|█████████████████▉                                        | 4026/12999 [01:11<07:59, 18.71it/s]
{'loss': 1.6929, 'learning_rate': 1.6169564642065997e-05, 'epoch': 0.93}


 31%|█████████████████▉                                        | 4028/12999 [01:16<14:55, 10.01it/s]

 31%|█████████████████▉                                        | 4029/12999 [01:19<16:30,  9.06it/s]

 31%|█████████████████▉                                        | 4030/12999 [01:21<16:30,  9.06it/s]

 31%|█████████████████▉                                        | 4031/12999 [01:24<16:29,  9.06it/s]

 31%|█████████████████▉                                        | 4032/12999 [01:27<16:29,  9.06it/s]

 31%|█████████████████▉                                        | 4033/12999 [01:29<16:29,  9.06it/s]

 31%|█████████████████▉                                        | 4034/12999 [01:32<16:29,  9.06it/s]

 31%|██████████████████                                        | 4035/12999 [01:35<16:29,  9.06it/s]

 31%|██████████████████                                        | 4036/12999 [01:37<31:30,  4.74it/s]
{'loss': 1.5932, 'learning_rate': 1.6149937098959663e-05, 'epoch': 0.93}


 31%|██████████████████                                        | 4038/12999 [01:42<34:26,  4.34it/s]

 31%|██████████████████                                        | 4039/12999 [01:45<34:26,  4.34it/s]
{'loss': 1.3045, 'learning_rate': 1.614404138584082e-05, 'epoch': 0.93}


 31%|██████████████████                                        | 4041/12999 [01:50<34:26,  4.34it/s]

 31%|██████████████████                                        | 4042/12999 [01:53<53:55,  2.77it/s]
{'loss': 1.5815, 'learning_rate': 1.613814224002809e-05, 'epoch': 0.93}


 31%|██████████████████                                        | 4044/12999 [01:58<59:06,  2.53it/s]

 31%|██████████████████                                        | 4045/12999 [02:01<59:05,  2.53it/s]

 31%|██████████████████                                        | 4046/12999 [02:03<59:05,  2.53it/s]

 31%|█████████████████▍                                      | 4047/12999 [02:06<1:26:28,  1.73it/s]

 31%|█████████████████▍                                      | 4048/12999 [02:09<1:35:49,  1.56it/s]
{'loss': 1.8573, 'learning_rate': 1.6126333663506334e-05, 'epoch': 0.93}


 31%|█████████████████▍                                      | 4050/12999 [02:14<1:35:48,  1.56it/s]

 31%|█████████████████▍                                      | 4051/12999 [02:17<2:07:29,  1.17it/s]
{'loss': 1.6708, 'learning_rate': 1.61204242393948e-05, 'epoch': 0.93}


 31%|█████████████████▍                                      | 4053/12999 [02:22<2:32:03,  1.02s/it]

 31%|█████████████████▍                                      | 4054/12999 [02:25<2:32:02,  1.02s/it]

 31%|█████████████████▍                                      | 4055/12999 [02:28<3:00:02,  1.21s/it]

 31%|█████████████████▍                                      | 4056/12999 [02:30<3:16:26,  1.32s/it]

 31%|█████████████████▍                                      | 4057/12999 [02:33<3:35:53,  1.45s/it]

 31%|█████████████████▍                                      | 4058/12999 [02:35<3:57:38,  1.59s/it]

 31%|█████████████████▍                                      | 4059/12999 [02:38<4:20:35,  1.75s/it]

 31%|█████████████████▍                                      | 4060/12999 [02:41<4:43:50,  1.91s/it]

 31%|█████████████████▍                                      | 4061/12999 [02:43<5:06:45,  2.06s/it]

 31%|█████████████████▍                                      | 4062/12999 [02:46<5:26:13,  2.19s/it]

 31%|█████████████████▌                                      | 4063/12999 [02:49<5:41:44,  2.29s/it]

 31%|█████████████████▌                                      | 4064/12999 [02:51<5:54:24,  2.38s/it]
{'loss': 1.6618, 'learning_rate': 1.609477726313157e-05, 'epoch': 0.94}


 31%|█████████████████▌                                      | 4066/12999 [02:56<6:11:00,  2.49s/it]

 31%|█████████████████▌                                      | 4067/12999 [02:59<6:20:03,  2.55s/it]
{'loss': 1.4898, 'learning_rate': 1.6088849639890967e-05, 'epoch': 0.94}


 31%|█████████████████▌                                      | 4069/12999 [03:04<6:25:17,  2.59s/it]

 31%|█████████████████▌                                      | 4070/12999 [03:07<6:27:14,  2.60s/it]
{'loss': 1.7599, 'learning_rate': 1.6082918614792262e-05, 'epoch': 0.94}


 31%|█████████████████▌                                      | 4072/12999 [03:12<6:28:30,  2.61s/it]

 31%|█████████████████▌                                      | 4073/12999 [03:15<6:28:59,  2.61s/it]

 31%|█████████████████▌                                      | 4074/12999 [03:18<6:28:50,  2.61s/it]

 31%|█████████████████▌                                      | 4075/12999 [03:20<6:29:48,  2.62s/it]

 31%|█████████████████▌                                      | 4076/12999 [03:23<6:29:37,  2.62s/it]

 31%|█████████████████▌                                      | 4077/12999 [03:25<6:29:13,  2.62s/it]

 31%|█████████████████▌                                      | 4078/12999 [03:28<6:29:41,  2.62s/it]

 31%|█████████████████▌                                      | 4079/12999 [03:31<6:29:23,  2.62s/it]

 31%|█████████████████▌                                      | 4080/12999 [03:33<6:30:17,  2.63s/it]
{'loss': 1.7284, 'learning_rate': 1.6063124004714952e-05, 'epoch': 0.94}


 31%|█████████████████▌                                      | 4082/12999 [03:39<6:29:23,  2.62s/it]

 31%|█████████████████▌                                      | 4083/12999 [03:41<6:29:48,  2.62s/it]
{'loss': 1.5876, 'learning_rate': 1.6057178276546915e-05, 'epoch': 0.94}


 31%|█████████████████▌                                      | 4085/12999 [03:46<6:29:06,  2.62s/it]

 31%|█████████████████▌                                      | 4086/12999 [03:49<6:28:58,  2.62s/it]

 31%|█████████████████▌                                      | 4087/12999 [03:52<6:29:33,  2.62s/it]

 31%|█████████████████▌                                      | 4088/12999 [03:54<6:29:31,  2.62s/it]

 31%|█████████████████▌                                      | 4089/12999 [03:57<6:30:27,  2.63s/it]
{'loss': 1.4673, 'learning_rate': 1.6045276671044967e-05, 'epoch': 0.94}


 31%|█████████████████▌                                      | 4091/12999 [04:02<6:29:03,  2.62s/it]

 31%|█████████████████▋                                      | 4092/12999 [04:05<6:29:16,  2.62s/it]

 31%|█████████████████▋                                      | 4093/12999 [04:07<6:28:52,  2.62s/it]
{'loss': 1.5147, 'learning_rate': 1.6037334760148833e-05, 'epoch': 0.94}


 32%|█████████████████▋                                      | 4095/12999 [04:13<6:28:40,  2.62s/it]

 32%|█████████████████▋                                      | 4096/12999 [04:15<6:28:34,  2.62s/it]
{'loss': 1.7897, 'learning_rate': 1.6031374391289238e-05, 'epoch': 0.95}


 32%|█████████████████▋                                      | 4098/12999 [04:20<6:28:53,  2.62s/it]

 32%|█████████████████▋                                      | 4099/12999 [04:23<6:29:40,  2.63s/it]

 32%|█████████████████▋                                      | 4100/12999 [04:26<6:30:02,  2.63s/it]

 32%|█████████████████▋                                      | 4101/12999 [04:28<6:29:21,  2.63s/it]

 32%|█████████████████▋                                      | 4102/12999 [04:31<6:29:07,  2.62s/it]

 32%|█████████████████▋                                      | 4103/12999 [04:34<6:28:47,  2.62s/it]

 32%|█████████████████▋                                      | 4104/12999 [04:36<6:28:10,  2.62s/it]

 32%|█████████████████▋                                      | 4105/12999 [04:39<6:28:10,  2.62s/it]

 32%|█████████████████▋                                      | 4106/12999 [04:41<6:28:07,  2.62s/it]
{'loss': 1.8218, 'learning_rate': 1.6011482176752498e-05, 'epoch': 0.95}


 32%|█████████████████▋                                      | 4108/12999 [04:47<6:29:24,  2.63s/it]

 32%|█████████████████▋                                      | 4109/12999 [04:49<6:28:41,  2.62s/it]
{'loss': 1.5272, 'learning_rate': 1.6005507229732703e-05, 'epoch': 0.95}


 32%|█████████████████▋                                      | 4111/12999 [04:55<6:28:50,  2.62s/it]

 32%|█████████████████▋                                      | 4112/12999 [04:57<6:28:49,  2.63s/it]
{'loss': 1.5215, 'learning_rate': 1.599952892741846e-05, 'epoch': 0.95}


 32%|█████████████████▋                                      | 4114/12999 [05:02<6:28:38,  2.62s/it]

 32%|█████████████████▋                                      | 4115/12999 [05:05<6:28:17,  2.62s/it]

 32%|█████████████████▋                                      | 4116/12999 [05:08<6:28:34,  2.62s/it]

 32%|█████████████████▋                                      | 4117/12999 [05:10<6:27:51,  2.62s/it]

 32%|█████████████████▋                                      | 4118/12999 [05:13<6:29:49,  2.63s/it]

 32%|█████████████████▋                                      | 4119/12999 [05:16<6:29:40,  2.63s/it]

 32%|█████████████████▋                                      | 4120/12999 [05:18<6:29:40,  2.63s/it]

 32%|█████████████████▊                                      | 4121/12999 [05:21<6:28:40,  2.63s/it]

 32%|█████████████████▊                                      | 4122/12999 [05:23<6:28:51,  2.63s/it]
{'loss': 1.5209, 'learning_rate': 1.5979577063254644e-05, 'epoch': 0.95}


 32%|█████████████████▊                                      | 4124/12999 [05:29<6:28:01,  2.62s/it]

 32%|█████████████████▊                                      | 4125/12999 [05:31<6:27:26,  2.62s/it]
{'loss': 1.5157, 'learning_rate': 1.5973584259951774e-05, 'epoch': 0.95}


 32%|█████████████████▊                                      | 4127/12999 [05:37<6:27:46,  2.62s/it]

 32%|█████████████████▊                                      | 4128/12999 [05:39<6:27:34,  2.62s/it]

 32%|█████████████████▊                                      | 4129/12999 [05:42<6:27:35,  2.62s/it]

 32%|█████████████████▊                                      | 4130/12999 [05:44<6:27:09,  2.62s/it]

 32%|█████████████████▊                                      | 4131/12999 [05:47<6:27:18,  2.62s/it]

 32%|█████████████████▊                                      | 4132/12999 [05:50<6:27:36,  2.62s/it]

 32%|█████████████████▊                                      | 4133/12999 [05:52<6:27:21,  2.62s/it]

 32%|█████████████████▊                                      | 4134/12999 [05:55<6:27:47,  2.62s/it]

 32%|█████████████████▊                                      | 4135/12999 [05:58<6:27:03,  2.62s/it]
{'loss': 1.5397, 'learning_rate': 1.595358416389338e-05, 'epoch': 0.95}


 32%|█████████████████▊                                      | 4137/12999 [06:03<6:28:05,  2.63s/it]

 32%|█████████████████▊                                      | 4138/12999 [06:05<6:28:51,  2.63s/it]
{'loss': 1.6909, 'learning_rate': 1.594757692247352e-05, 'epoch': 0.95}


 32%|█████████████████▊                                      | 4140/12999 [06:11<6:28:58,  2.63s/it]

 32%|█████████████████▊                                      | 4141/12999 [06:13<6:29:11,  2.64s/it]
{'loss': 1.3912, 'learning_rate': 1.5941566358125043e-05, 'epoch': 0.96}


 32%|█████████████████▊                                      | 4143/12999 [06:19<6:27:46,  2.63s/it]

 32%|█████████████████▊                                      | 4144/12999 [06:21<6:27:22,  2.62s/it]

 32%|█████████████████▊                                      | 4145/12999 [06:24<6:27:43,  2.63s/it]
{'loss': 1.3787, 'learning_rate': 1.593354710913141e-05, 'epoch': 0.96}


 32%|█████████████████▊                                      | 4147/12999 [06:29<6:26:58,  2.62s/it]

 32%|█████████████████▊                                      | 4148/12999 [06:32<6:27:00,  2.62s/it]
{'loss': 1.8706, 'learning_rate': 1.592752880434537e-05, 'epoch': 0.96}


 32%|█████████████████▉                                      | 4150/12999 [06:37<6:27:32,  2.63s/it]

 32%|█████████████████▉                                      | 4151/12999 [06:40<6:27:18,  2.63s/it]
{'loss': 1.6425, 'learning_rate': 1.5921507187831646e-05, 'epoch': 0.96}


 32%|█████████████████▉                                      | 4153/12999 [06:45<6:27:40,  2.63s/it]

 32%|█████████████████▉                                      | 4154/12999 [06:48<6:27:36,  2.63s/it]
{'loss': 1.4257, 'learning_rate': 1.5915482262954532e-05, 'epoch': 0.96}

 32%|█████████████████▉                                      | 4155/12999 [06:50<6:26:58,  2.63s/it]


 32%|█████████████████▉                                      | 4157/12999 [06:55<6:25:41,  2.62s/it]

 32%|█████████████████▉                                      | 4158/12999 [06:58<6:26:11,  2.62s/it]
{'loss': 1.6559, 'learning_rate': 1.590744388926029e-05, 'epoch': 0.96}


 32%|█████████████████▉                                      | 4160/12999 [07:03<6:27:03,  2.63s/it]

 32%|█████████████████▉                                      | 4161/12999 [07:06<6:27:07,  2.63s/it]
{'loss': 1.9059, 'learning_rate': 1.590141125796236e-05, 'epoch': 0.96}


 32%|█████████████████▉                                      | 4163/12999 [07:11<6:26:25,  2.62s/it]

 32%|█████████████████▉                                      | 4164/12999 [07:14<6:27:02,  2.63s/it]
{'loss': 1.7506, 'learning_rate': 1.5895375329528693e-05, 'epoch': 0.96}


 32%|█████████████████▉                                      | 4166/12999 [07:19<6:28:08,  2.64s/it]

 32%|█████████████████▉                                      | 4167/12999 [07:22<6:27:04,  2.63s/it]
{'loss': 1.7422, 'learning_rate': 1.588933610733159e-05, 'epoch': 0.96}


 32%|█████████████████▉                                      | 4169/12999 [07:27<6:25:52,  2.62s/it]

 32%|█████████████████▉                                      | 4170/12999 [07:30<6:26:48,  2.63s/it]
{'loss': 1.7309, 'learning_rate': 1.5883293594745168e-05, 'epoch': 0.96}

 32%|█████████████████▉                                      | 4171/12999 [07:32<6:26:40,  2.63s/it]


 32%|█████████████████▉                                      | 4173/12999 [07:37<6:26:32,  2.63s/it]

 32%|█████████████████▉                                      | 4174/12999 [07:40<6:26:04,  2.62s/it]
{'loss': 1.2887, 'learning_rate': 1.5875231798748513e-05, 'epoch': 0.96}


 32%|█████████████████▉                                      | 4176/12999 [07:45<6:25:39,  2.62s/it]

 32%|█████████████████▉                                      | 4177/12999 [07:48<6:25:16,  2.62s/it]
{'loss': 1.62, 'learning_rate': 1.586918162171898e-05, 'epoch': 0.96}


 32%|██████████████████                                      | 4179/12999 [07:53<6:26:25,  2.63s/it]

 32%|██████████████████                                      | 4180/12999 [07:56<6:26:14,  2.63s/it]
{'loss': 1.6361, 'learning_rate': 1.5863128165560508e-05, 'epoch': 0.96}


 32%|██████████████████                                      | 4182/12999 [08:01<6:26:02,  2.63s/it]

 32%|██████████████████                                      | 4183/12999 [08:04<6:25:53,  2.63s/it]
{'loss': 1.6296, 'learning_rate': 1.5857071433655185e-05, 'epoch': 0.97}


 32%|██████████████████                                      | 4185/12999 [08:09<6:25:41,  2.63s/it]

 32%|██████████████████                                      | 4186/12999 [08:12<6:26:17,  2.63s/it]
{'loss': 1.5985, 'learning_rate': 1.585101142938691e-05, 'epoch': 0.97}

 32%|██████████████████                                      | 4187/12999 [08:14<6:25:59,  2.63s/it]


 32%|██████████████████                                      | 4189/12999 [08:19<6:26:10,  2.63s/it]

 32%|██████████████████                                      | 4190/12999 [08:22<6:25:38,  2.63s/it]
  File "/home/hdd/fujiayun/PromptPoison/train.py", line 232, in <module>9 [08:22<6:25:38,  2.63s/it]
    train()
  File "/home/hdd/fujiayun/PromptPoison/train.py", line 226, in train
    trainer.train(resume_from_checkpoint="models/checkpoint-4000")
  File "/home/hdd/fujiayun/miniconda3/envs/LLM/lib/python3.10/site-packages/transformers/trainer.py", line 1633, in train
    return inner_training_loop(
  File "/home/hdd/fujiayun/miniconda3/envs/LLM/lib/python3.10/site-packages/transformers/trainer.py", line 1900, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
  File "/home/hdd/fujiayun/miniconda3/envs/LLM/lib/python3.10/site-packages/transformers/trainer.py", line 2663, in training_step
    loss.backward()
  File "/home/hdd/fujiayun/miniconda3/envs/LLM/lib/python3.10/site-packages/torch/_tensor.py", line 487, in backward
    torch.autograd.backward(
  File "/home/hdd/fujiayun/miniconda3/envs/LLM/lib/python3.10/site-packages/torch/autograd/__init__.py", line 200, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt